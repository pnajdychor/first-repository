# Practical Exercise 29 - Adding the Ping Logic in Python

## Exercise Description (Opis ćwiczenia)

### English Version

In this practical exercise, our goal is to finish the logic for the ping functionality and complete the respective workflow.

Here are the instructions for the exercise:

1. Extend the workflow `17-3-custom-actions-docker.yaml` by:
   a. Changing the `url` input type to *choice*, and provide two options: one with the URL of an existing website, and another with an unreachable URL.  
   b. Adding a second input named `max_trials`, with a description of *Maximum trials until action fails*, a default value of `'10'`, and not required.  
   c. Adding a third input named `delay`, with a description of *Delay in seconds between trials*, a default value of `'5'`, and not required.  
   d. Correctly passing the values of all inputs to the underlying Docker custom action.

2. Update the Python script with the logic for the Ping functionality:
   a. Define a new function named `ping_url`:  
      i. The function should receive three parameters: the `url`, the `delay`, and the `max_trials`.  
      ii. While the number of trials is less than `max_trials`, make a request to the provided URL. If the response code is 200, return `True`. If the response code is not 200, sleep for the duration of `delay` and increase the number of trials.  
      iii. If the number of trials exceeds `max_trials`, return `False`.  
   b. Define a new function named `run`:  
      i. The function should not receive any parameters.  
      ii. It should retrieve the input values via environment variables (for each input, there is an environment variable named `INPUT_<input name in capital letters>`) and call the `ping_url` function with the correct arguments.  
      iii. If the return value of `ping_url` is `False`, the function should raise an exception; otherwise, it should not return anything.  
   c. Update the body of the `if __name__ == "__main__":` condition to call the `run` function.

3. Commit the changes and push the code. Trigger the workflow from the UI and take a few moments to inspect the output of the workflow run.

---

### Polish Translation

W tym ćwiczeniu praktycznym naszym celem jest dokończenie logiki funkcjonalności ping oraz ukończenie odpowiedniego workflow.

Instrukcje do wykonania ćwiczenia:

1. Rozszerz workflow `17-3-custom-actions-docker.yaml` poprzez:
   a. Zmianę typu wejścia `url` na *choice* i dodanie dwóch opcji: jednej z adresem istniejącej strony internetowej oraz drugiej z nieosiągalnym adresem URL.  
   b. Dodanie drugiego wejścia o nazwie `max_trials` z opisem *Maksymalna liczba prób zanim akcja się nie powiedzie*, wartością domyślną `'10'` i ustawieniem jako niewymagane.  
   c. Dodanie trzeciego wejścia o nazwie `delay` z opisem *Opóźnienie w sekundach między próbami*, wartością domyślną `'5'` i ustawieniem jako niewymagane.  
   d. Poprawne przekazanie wartości wszystkich wejść do bazowej niestandardowej akcji Dockera.

2. Zaktualizuj skrypt Python, aby dodać logikę funkcjonalności Ping:
   a. Zdefiniuj nową funkcję o nazwie `ping_url`:  
      i. Funkcja powinna przyjmować trzy parametry: `url`, `delay` oraz `max_trials`.  
      ii. Dopóki liczba prób jest mniejsza niż `max_trials`, wykonuj żądanie do podanego adresu URL. Jeśli kod odpowiedzi to 200, zwróć `True`. Jeśli kod odpowiedzi nie jest 200, wstrzymaj działanie na czas `delay` i zwiększ liczbę prób.  
      iii. Jeśli liczba prób przekroczy `max_trials`, zwróć `False`.  
   b. Zdefiniuj nową funkcję o nazwie `run`:  
      i. Funkcja nie powinna przyjmować żadnych parametrów.  
      ii. Powinna pobierać wartości wejściowe za pomocą zmiennych środowiskowych (dla każdego wejścia istnieje zmienna środowiskowa o nazwie `INPUT_<nazwa wejścia dużymi literami>`) i wywoływać funkcję `ping_url` z odpowiednimi argumentami.  
      iii. Jeśli wartość zwrócona przez `ping_url` to `False`, funkcja powinna zgłosić wyjątek; w przeciwnym razie nie powinna nic zwracać.  
   c. Zaktualizuj ciało warunku `if __name__ == "__main__":`, aby wywoływać funkcję `run`.

3. Zatwierdź zmiany i wypchnij kod. Uruchom workflow z poziomu interfejsu użytkownika i poświęć chwilę, aby przeanalizować wynik działania workflow.
